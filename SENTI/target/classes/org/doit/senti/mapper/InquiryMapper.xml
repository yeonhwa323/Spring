<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="org.doit.senti.mapper.InquiryMapper">

	<!-- // 문의내역 갯수 반환하는 메서드
	public int getCount(String field, String query) throws ClassNotFoundException, SQLException; -->
	<select id="getCount" resultType="Integer">
		SELECT COUNT(*) CNT
		FROM inquiry
		WHERE ${param1} LIKE '%${param2}%'
	</select>
	
	<!-- // 문의내역 리스트
	public List<InquiryVO> getInquirys ( int page // 현재 페이지 번호, String field // 검색조건 , String query // 검색어 
	) throws ClassNotFoundException, SQLException; -->
	<select id="getInquirys" resultType="InquiryVO">
		SELECT *
		FROM (
			SELECT ROWNUM NUM, N.*
			FROM (
				SELECT *
				FROM inquiry
				WHERE ${param2} LIKE '%${param3}%'
				ORDER BY inquiry_date DESC
				) N
			)
		WHERE NUM BETWEEN (1 + (#{param1}-1)*15) AND (15 + (#{param1}-1)*15)
	</select>
	
	<!-- // 문의내역 삭제하는 메서드
	public int delete(String inquiryId) throws ClassNotFoundException, SQLException; -->	
	<delete id="delete">
		DELETE inquiry
		WHERE inquiry_id= #{inquiryId}
	</delete>
		
  <insert id="insert" parameterType="org.doit.senti.domain.board.InquiryVO">
  	INSERT INTO inquiry
	(inquiry_id, inquiry_title, inquiry_content,inquiry_date, filesrc, buy_inquiry, general_inquiry_id, etc_inquiry, member_id) 
	VALUES( (SELECT NVL(MAX(TO_NUMBER(inquiryId)),0)+1 FROM inquiry), #{inquiryTitle}, #{inquiryContent}, SYSDATE, #{filesrc}, #{buyInquiry}, #{generalInquiryId}, #{etcInquiry}, #{memberId} )
  </insert>
  
  
  <select id="getInquiry" resultType="org.doit.senti.domain.board.InquiryVO">
	    SELECT COUNT(*)
	    FROM inquiry
	    WHERE member_id = #{member_id}
 	</select>
  
  
</mapper>
 